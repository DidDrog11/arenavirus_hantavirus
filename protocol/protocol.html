<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="David Simons">
<meta name="author" content="Ricardo Rivero">
<meta name="author" content="Harry Gordon">
<meta name="author" content="Anna Martinez-Checa">
<meta name="author" content="David Redding">
<meta name="author" content="Stephanie Seifert">
<meta name="dcterms.date" content="2024-09-09">

<title>Study protocol: Production of Arenavirus and Hantavirus host-pathogen database.</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="protocol_files/libs/clipboard/clipboard.min.js"></script>
<script src="protocol_files/libs/quarto-html/quarto.js"></script>
<script src="protocol_files/libs/quarto-html/popper.min.js"></script>
<script src="protocol_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="protocol_files/libs/quarto-html/anchor.min.js"></script>
<link href="protocol_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="protocol_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="protocol_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="protocol_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="protocol_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#motivation" id="toc-motivation" class="nav-link active" data-scroll-target="#motivation">Motivation</a></li>
  <li><a href="#method" id="toc-method" class="nav-link" data-scroll-target="#method">Method</a>
  <ul class="collapse">
  <li><a href="#search-strategy" id="toc-search-strategy" class="nav-link" data-scroll-target="#search-strategy">Search strategy</a></li>
  <li><a href="#study-screening" id="toc-study-screening" class="nav-link" data-scroll-target="#study-screening">Study screening</a></li>
  <li><a href="#data-extraction" id="toc-data-extraction" class="nav-link" data-scroll-target="#data-extraction">Data extraction</a>
  <ul class="collapse">
  <li><a href="#included-studies" id="toc-included-studies" class="nav-link" data-scroll-target="#included-studies">Included studies</a></li>
  <li><a href="#rodent-sampling" id="toc-rodent-sampling" class="nav-link" data-scroll-target="#rodent-sampling">Rodent sampling</a></li>
  <li><a href="#pathogen-sampling" id="toc-pathogen-sampling" class="nav-link" data-scroll-target="#pathogen-sampling">Pathogen sampling</a></li>
  <li><a href="#pathogen-sequences" id="toc-pathogen-sequences" class="nav-link" data-scroll-target="#pathogen-sequences">Pathogen sequences</a></li>
  <li><a href="#zoonosis-status" id="toc-zoonosis-status" class="nav-link" data-scroll-target="#zoonosis-status">Zoonosis status</a></li>
  </ul></li>
  <li><a href="#data-processing" id="toc-data-processing" class="nav-link" data-scroll-target="#data-processing">Data processing</a></li>
  <li><a href="#data-management-and-accessibility" id="toc-data-management-and-accessibility" class="nav-link" data-scroll-target="#data-management-and-accessibility">Data management and accessibility</a></li>
  </ul></li>
  <li><a href="#expected-outputs" id="toc-expected-outputs" class="nav-link" data-scroll-target="#expected-outputs">Expected outputs</a>
  <ul class="collapse">
  <li><a href="#database" id="toc-database" class="nav-link" data-scroll-target="#database">Database</a></li>
  <li><a href="#data-visualisation" id="toc-data-visualisation" class="nav-link" data-scroll-target="#data-visualisation">Data visualisation</a></li>
  <li><a href="#use-cases" id="toc-use-cases" class="nav-link" data-scroll-target="#use-cases">Use cases</a></li>
  </ul></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion">Discussion</a>
  <ul class="collapse">
  <li><a href="#strengths-and-limitations" id="toc-strengths-and-limitations" class="nav-link" data-scroll-target="#strengths-and-limitations">Strengths and limitations</a></li>
  <li><a href="#future-directions" id="toc-future-directions" class="nav-link" data-scroll-target="#future-directions">Future directions</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a>
  <ul class="collapse">
  <li><a href="#rodent-sampling-1" id="toc-rodent-sampling-1" class="nav-link" data-scroll-target="#rodent-sampling-1">Rodent sampling</a></li>
  <li><a href="#pathogen-detection" id="toc-pathogen-detection" class="nav-link" data-scroll-target="#pathogen-detection">Pathogen detection</a></li>
  <li><a href="#host-pathogen-associations" id="toc-host-pathogen-associations" class="nav-link" data-scroll-target="#host-pathogen-associations">Host pathogen associations</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content column-page-right" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Study protocol: Production of Arenavirus and Hantavirus host-pathogen database.</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Arenavirus</div>
    <div class="quarto-category">Hantavirus</div>
  </div>
  </div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author"><a href="https://www.dsimons.org">David Simons</a> </p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            The Royal Veterinary College, London, UK
          </p>
      </div>
      <div class="quarto-title-meta-contents">
    <p class="author">Ricardo Rivero </p>
  </div>
      <div class="quarto-title-meta-contents">
    <p class="author">Harry Gordon </p>
  </div>
      <div class="quarto-title-meta-contents">
    <p class="author">Anna Martinez-Checa </p>
  </div>
      <div class="quarto-title-meta-contents">
    <p class="author">David Redding </p>
  </div>
      <div class="quarto-title-meta-contents">
    <p class="author">Stephanie Seifert </p>
  </div>
    </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 9, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>Target journals:</p>
<ol type="1">
<li>Scientific Data unclear if they accept protocols but may be worth a try?<br>
</li>
<li>Gigabyte?<br>
</li>
<li>Open Research Europe/F1000 or similar</li>
</ol>
<section id="motivation" class="level1">
<h1>Motivation</h1>
<p>Current host-pathogen association datasets provide synthesised information on hosts and their pathogens but do not contain temporal or geographic information. These resources often provide linking information to publications reporting the association but information including accession numbers of archived sequences, number of individuals tested and measures of prevalence among sampled populations are not immediately retrievable. Using these resources for inference beyond host-pathogen associations is therefore limited. Here, we aim to produce a database of host-pathogen associations for two viral families of small mammals which contain several known zoonoses, namely Arenaviridae and Hantaviridae. This database can be used to explore the distribution of small mammal hosts of known and suspected pathogens and the extent to which they have been sampled. Further, linkage to sequence data of known zoonoses will support analysis of the risk of viral reassortment between viral species within geographically co-located host species.</p>
</section>
<div class="columns">
<div class="column" style="width:50%;">
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Arenaviruses and Hantaviruses are globally distributed pathogens primarily infecting rodents and other small mammals [ref]. Several of these pathogens sporadically spillover into human populations where they are responsible for substantial morbidity and mortality within their endemic regions [ref]. Arenaviruses, including <em>Mammarenavirus lassaense</em> (LASV) and <em>Mammarenavirus juninense</em> (JUNV), cause viral haemorrhagic fevers such as Lassa fever in West Africa and Argentine haemorrhagic fever. In contrast, Mammarenavirus choriomeningitidis has a global distribution and causes Lymphocytic choriomeningitis, an aseptic meningitis [ref]. Hantaviruses, such as <em>Orthohantavirus puumalaense</em> (PUUV) and <em>Orthohantavirus seoulense</em> (SEOV) cause haemorrhagic fever with renal syndrome, while in the Americas <em>Orthohantavirus sinnombreense</em> (SNV) is the causative agent of hantavirus pulmonary syndrome [ref]. The distribution and human health impact of hantaviruses in Africa is poorly understood [ref].</p>
<p>Novel Arenaviruses and Hantaviruses continue to be described, with new species evolving and emerging in the Anthropocene [ref]. Deforestation, urbanization, and agricultural expansion bring humans into closer contact with rodent reservoirs, increasing the likelihood of spillover events. For example, agricultural encroachment in West Africa has been linked to increased human exposure to LASV-carrying rodents [ref]. Changes in climate, land use, rodent ecology, and human behaviour alter human-reservoir contact, which is a component of a complex human-animal-environment nexus driving spillover and maintenance of novel pathogens [ref]. Although these pathogens remain endemic diseases with limited human-to-human transmission, there is concern about the potential emergence of novel strains that could sustain human-to-human transmission, leading to LASV’s classification as a priority disease by the WHO [ref].</p>
<p>A broader understanding of the economic and societal impacts of these pathogens is also required. The economic burden of arenavirus and hantavirus infections extends beyond healthcare costs to include long-term productivity losses and the economic strain on already vulnerable populations. The Four Corners outbreak of HPS led to significant economic disruption in affected communities, demonstrating the far-reaching consequences of these diseases [ref]. Lasting health and wellbeing impacts following infection are also likely. Infection with LASV is presumed to lead to symptomatic Lassa fever in only 20% of infections, the remaining 80% are presumed to have asymptomatic disease [ref]. Sensorineural hearing impairment is considered a sequelae of symptomatic infection, the prevalence of this in the asymptomatic population has not been convincingly assessed and therefore disease associated morbidity may be substantially under-reported in the endemic region.</p>
<p>Small mammals, primarily rodents (Rodentia), but also shrews (Soricidae) are reservoirs of zoonotic arenaviruses and hantaviruses [ref]. Traditionally these pathogens, particularly hantaviruses have been considered single reservoir species but this paradigm is changing with increased pathogen surveillance in endemic settings. Multiple potential hosts have been identified for pathogens including LASV, SEOV and SNV. Similarly, a single host species may be a host of multiple arenaviruses and hantaviruses throughout its geographic distribution, for example <em>Mastomys natalensis</em>, the primary host of LASV is the host of at least 7 distinct arenaviruses throughout its range <span class="citation" data-cites="de2020dhati">[@de2020dhati]</span>.</p>
<p>The ecology of these hosts, including their population dynamics, behaviour, habitat preferences, and interactions within their communities, directly influences pathogen transmission dynamics. Linking ecological and genomic data allows for the identification of genetic markers associated with increased virulence or transmissibility, providing critical insights into the evolutionary trajectories of arenaviruses and hantaviruses [ref]. Small-mammal sampling to quantify these parameters, is vital to better understand ecological factors driving pathogen spillover. Existing data on rodent-pathogen associations from these studies is typically at a local scale and often lack comprehensive geographic and temporal information which hampers research into the full scope of host-pathogen interactions which requires synthesised and standardised data sources.</p>
<p>Additionally, human disease data is often reported at national or subnational scales, to preserve patient anonymity, making it challenging to directly link ecological findings with human infection risk. A unified dataset that includes detailed spatial and temporal data could serve as a critical tool for connecting local ecological data with broader-scale public health patterns, enhancing the ability to identify hotspots of transmission risk and inform targeted interventions [ref].</p>
<p>Research efforts have also been unevenly distributed, with high-risk but understudied regions often lacking sufficient sampling intensity, particularly in Africa and Southeast Asia [ref]. Identifying these undersampled areas is essential for guiding future viral discovery and research prioritisation. This requires a comprehensive understanding of global sampling efforts within and between different host and pathogen taxa, helping to pinpoint gaps in knowledge and inform future research priorities.</p>
<p>Local-scale, high-intensity research can provide valuable insights into host-pathogen dynamics, but data fragmentation limits the ability to connect this high-resolution information to broader-scale patterns (i.e., human infection) [ref]. This impairs efforts to identify larger-scale trends that could inform public health strategies and disease management. For example, a better linkage of ecological and genomic data could facilitate a better understanding of the drivers of viral evolution, reassortment, and the emergence of novel pathogens with zoonotic potential. A unified dataset could enable better predictive modelling and outbreak response strategies, addressing current data fragmentation and improving risk assessments and public health interventions.</p>
<p>A detailed dataset on the current state of sampling for arenaviruses and hantaviruses in wild caught small-mammals is therefore urgently needed. Synthesising spatial, temporal and genomic data from previously published small-mammal sampling studies will provide the most comprehensive index of host-pathogen associations for these viral families in addition to identifying locations and potential hosts that have been relatively undersampled and which may benefit from targeted viral discovery. This dataset is expected to provide a key resource for the development of targeted public health interventions, risk mapping and predictive modelling of future outbreaks.</p>
<p>Following Open Science principles, we will share research tools, data extraction methods, and processing code on suitable platforms, ensuring adherence to the FAIR principles (Findable, Accessible, Interoperable, Reusable). The dataset will be accessible to researchers, policymakers, and public health officials worldwide, fostering evidence-based decision-making and international collaboration in disease surveillance. It will be submitted to a suitable data repository (e.g., the Global Biodiversity Information Facility) <span class="citation" data-cites="wilkinson2016fair gbif">[@wilkinson2016fair; @gbif]</span>.</p>
</section>
</div><div class="column" style="width:50%;">
<section id="introduction-v3" class="level1">
<h1>Introduction v3</h1>
<p>Arenaviruses and Hantaviruses are globally distributed pathogens primarily infecting rodents and other small mammals [ref]. Several of these pathogens sporadically spillover into human populations where they are responsible for substantial morbidity and mortality within their endemic regions [ref]. Arenaviruses, including Mammarenavirus lassaense (LASV) and Mammarenavirus juninense (JUNV), cause viral haemorrhagic fevers such as Lassa fever in West Africa and Argentine haemorrhagic fever. In contrast, Mammarenavirus choriomeningitidis has a global distribution and causes Lymphocytic choriomeningitis, an aseptic meningitis [ref]. Hantaviruses, such as Orthohantavirus puumalaense (PUUV) and Orthohantavirus seoulense (SEOV), cause haemorrhagic fever with renal syndrome, while in the Americas Orthohantavirus sinnombreense (SNV) is the causative agent of hantavirus pulmonary syndrome [ref]. However, despite the significance of these pathogens, comprehensive data on their distribution and health impacts remain limited, especially in under-researched regions such as Africa [ref].</p>
<p>Despite ongoing viral surveillance, the emergence of novel arenaviruses and hantaviruses continues, driven by human activities such as deforestation, urbanization, and agricultural expansion that increase contact between humans and rodent reservoirs [ref]. For instance, changes in land use in West Africa have been linked to increased human exposure to LASV-carrying rodents [ref]. Although current evidence suggests these pathogens primarily exhibit limited human-to-human transmission, concerns remain about the potential for novel strains to sustain transmission between humans [ref].</p>
<p>The economic and societal impacts of arenaviruses and hantaviruses extend beyond healthcare costs to include productivity losses and long-term impacts on affected communities. For example, the Four Corners outbreak of hantavirus pulmonary syndrome (HPS) led to significant economic disruption in affected communities [ref]. These diseases may also have under-reported impacts; while Lassa fever is symptomatic in only 20% of LASV infections, sequelae such as sensorineural hearing impairment are prevalent among symptomatic cases but not well assessed among asymptomatic individuals, potentially leading to substantial underestimation of disease-associated morbidity [ref].</p>
<p>Small mammals, particularly rodents (Rodentia) and shrews (Soricidae), serve as primary reservoirs for arenaviruses and hantaviruses [ref]. While traditionally viewed as single-reservoir species, recent research has identified multiple potential hosts for viruses like LASV, SEOV, and SNV, reflecting a complex ecological picture. Similarly, a single rodent species can host multiple distinct arenaviruses and hantaviruses, underscoring the need for a comprehensive understanding of host-pathogen dynamics <span class="citation" data-cites="de2020dhati">[@de2020dhati]</span>.</p>
<p>Existing data on rodent-pathogen associations are often limited to local scales, lacking comprehensive spatial, temporal, and genomic information necessary to understand broader host-pathogen interactions. These limitations impede efforts to accurately assess spillover risks and transmission dynamics. A unified, detailed dataset linking ecological and genomic data would provide critical insights into the evolutionary pathways and transmissibility of these pathogens, enabling better identification of transmission hotspots and targeted interventions.</p>
<p>Human disease data, often reported at national or subnational scales, presents another challenge by complicating efforts to link ecological findings with human infection risk. There is an urgent need for a unified dataset that integrates spatial, temporal, and genomic data from published small-mammal sampling studies to improve risk assessments and public health strategies [ref].</p>
<p>The development of a comprehensive dataset synthesising existing data on arenavirus and hantavirus host-pathogen associations will address key gaps in current knowledge. This dataset will facilitate predictive modelling, risk mapping, and targeted interventions, identifying undersampled regions and host species that may benefit from future viral discovery efforts.</p>
<p>Our proposed dataset will adhere to Open Science principles, ensuring that data and research tools are accessible and reusable by the wider scientific community, public health officials, and policymakers. By adhering to FAIR principles (Findable, Accessible, Interoperable, Reusable), we aim to foster collaboration in disease surveillance and enhance our capacity to respond to future outbreaks. The dataset will be submitted to a suitable repository (e.g., the Global Biodiversity Information Facility) <span class="citation" data-cites="wilkinson2016fair gbif">[@wilkinson2016fair; @gbif]</span>.</p>
</section>
</div>
</div>
<section id="method" class="level1">
<h1>Method</h1>
<section id="search-strategy" class="level2">
<h2 class="anchored" data-anchor-id="search-strategy">Search strategy</h2>
<p>We searched NCBI PubMed and Clarivate Web of Science. We did not use any limits for publication date, language or geographic locations.</p>
<table class="table">
<thead>
<tr class="header">
<th>Search term</th>
<th>PubMed</th>
<th>Web of Science</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1. rodent*</td>
<td>175,084</td>
<td>175,258</td>
</tr>
<tr class="even">
<td>2. shrew</td>
<td>-</td>
<td>-</td>
</tr>
<tr class="odd">
<td>3. arenavir*</td>
<td>2,506</td>
<td>1,941</td>
</tr>
<tr class="even">
<td>4. hantavir*</td>
<td>4,274</td>
<td>5,016</td>
</tr>
<tr class="odd">
<td>5. 1 OR 2</td>
<td>-</td>
<td>-</td>
</tr>
<tr class="even">
<td>6. 2 OR 3</td>
<td>6,689</td>
<td>6,809</td>
</tr>
<tr class="odd">
<td>7. 1 AND 4</td>
<td>1,956</td>
<td>2,064</td>
</tr>
</tbody>
</table>
<p>Citations were downloaded from the searches and de-duplicated by matching on titles, authors, publication identifiers or digital object identifiers. The initial search resulted in 2,755 unique publications. These citations were uploaded to the Rayyan platform to assess against inclusion and exclusion criteria [ref].</p>
</section>
<section id="study-screening" class="level2">
<h2 class="anchored" data-anchor-id="study-screening">Study screening</h2>
<p>We screened studies against the following inclusion criteria. Studies were included if they reported:</p>
<ol type="1">
<li>Rodent OR Shrew sampling AND</li>
<li>Direct or indirect detection of microorganisms in the Arenaviridae and Hantaviridae families AND</li>
<li>Information on the sampling location of small mammals</li>
</ol>
<p>Studies were excluded if they did not contain information on the host species of the sample for direct or indirect detection of Arenaviridae or Hantaviridae. Studies reporting experimental infections or solely human infections were also excluded. Studies reported as abstract or conference proceedings were also excluded if they did not provide sufficient description of the method of animal sampling or microorganism detection.</p>
<p>Direct detection was defined as PCR or culture of virus and indirect detection was defined as detection of antibodies against an Arenaviridae or Hantaviridae.</p>
<p>We first screened study title and abstracts, for manuscripts not published in English we used the search datasets translation of titles and abstracts to assess against the inclusion and exclusion criteria. We then obtained full text articles for screening for all studies that were included at this stage. For articles published in languages other than English automated translation services (i.e., Google Translate) were used to prior to assessing the full text manuscript for inclusion.</p>
<p>Reference chaining was performed on studies considered for inclusion at the full text screening stage and relevant publications were added as manually identified relevant articles. Figure 1. shows the PRISMA flow chart for the search process. We intend to re-run the search when data extraction from the current round (search run on 2023-09-08) has been completed.</p>
</section>
<section id="data-extraction" class="level2">
<h2 class="anchored" data-anchor-id="data-extraction">Data extraction</h2>
<p>We aimed to extract included study meta-data and to produce three linked datasets that could used to assess sampling for a) small-mammal hosts, b) viral prevalence and c) genetic variability.</p>
<section id="included-studies" class="level3">
<h3 class="anchored" data-anchor-id="included-studies">Included studies</h3>
<p>Included study meta-data was abstracted to ensure appropriate attribution for the underlying data that would be extracted from the study. Each included study was provided an internal study_id unique identifier linked to the full text manuscript citation. Where we were unable to infer the sampling effort of small-mammals in the current study or associated manuscripts we recorded a value of not reported. We recorded the level of aggregation of the rodent sampling or pathogen sampling data and classified it as individual (data were provided at the level of individual small-mammals) or summarised (data were aggregated, e.g., at site or sampling session level).</p>
<div id="tbl-description" class="anchored">
<table class="table">
<caption>Table&nbsp;1: Study information extraction sheet</caption>
<colgroup>
<col style="width: 30%">
<col style="width: 69%">
</colgroup>
<thead>
<tr class="header">
<th>Column name</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>study_id</td>
<td style="text-align: left;">An internal unique identifier for the included study</td>
</tr>
<tr class="even">
<td>full_text_id</td>
<td style="text-align: left;">The internal ID for the full text manuscript and its associated citation</td>
</tr>
<tr class="odd">
<td>datasetName</td>
<td style="text-align: left;">The title of the manuscript, report or book section</td>
</tr>
<tr class="even">
<td>sampling_effort</td>
<td style="text-align: left;">A free text entry to capture the effort of sampling, ideally in trap nights for rodent studies</td>
</tr>
<tr class="odd">
<td>data_access</td>
<td style="text-align: left;">Whether data is available for individual small mammals or whether it is aggregated</td>
</tr>
<tr class="even">
<td>data_resolution</td>
<td style="text-align: left;">The level of aggregation available</td>
</tr>
<tr class="odd">
<td>linked_manuscripts</td>
<td style="text-align: left;">The DOI or weblink to other studies including the same dataset either in its entirety or a subset, this will be used to attempt to de-duplicate data</td>
</tr>
<tr class="even">
<td>notes</td>
<td style="text-align: left;">Details that may be important for interpreting the extracted data</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="rodent-sampling" class="level3">
<h3 class="anchored" data-anchor-id="rodent-sampling">Rodent sampling</h3>
<p>Rodent data is extracted in a <code>rodent</code> sheet. This will include information on the timing of data collection, the location of data collected, the small mammal species detected either as detection/non-detection or number detected. For studies not reporting the detection of an individual species at a location that has been detected at other locations the species will be entered as not-detected at that location.</p>
<div id="tbl-rodent" class="anchored">
<table class="table">
<caption>Table&nbsp;2: Rodent information extraction sheet</caption>
<colgroup>
<col style="width: 30%">
<col style="width: 69%">
</colgroup>
<thead>
<tr class="header">
<th>Column name</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>rodent_record_id</td>
<td style="text-align: left;">A unique identifier for the rodent species, at a specific location or timepoint reported by the study dependent on the level of aggregation reported in the study</td>
</tr>
<tr class="even">
<td>study_id</td>
<td style="text-align: left;">A unique identifier to link a study to the <code>descriptive</code> sheet entry for that study</td>
</tr>
<tr class="odd">
<td>date</td>
<td style="text-align: left;">The period in which data collection of rodent samples occurred, this will be extracted at the highest temporal resolution provided</td>
</tr>
<tr class="even">
<td>genus</td>
<td style="text-align: left;">The genus of the small-mammal as reported in the study</td>
</tr>
<tr class="odd">
<td>species</td>
<td style="text-align: left;">The species of the small-mammal as reported in the study</td>
</tr>
<tr class="even">
<td>location</td>
<td style="text-align: left;">The location of sampling effort, depending on how data are presented in the study this will match to the coordinates given for trapping effort. i.e.&nbsp;if trapping is aggregated at village level, village names will be used</td>
</tr>
<tr class="odd">
<td>country</td>
<td style="text-align: left;">Country where trapping occurred, for multinational studies where numbers are not disaggregated by country, all countries will be included</td>
</tr>
<tr class="even">
<td>habitat_type</td>
<td style="text-align: left;">High level habitat type will be recorded here at the scale for which trapping is recorded</td>
</tr>
<tr class="odd">
<td>coordinate_resolution</td>
<td style="text-align: left;">The description of coordinate levels provided in the study, i.e.&nbsp;aggregated at study site or study region</td>
</tr>
<tr class="even">
<td>latitude</td>
<td style="text-align: left;">Latitude will be converted from coordinates presented to EPSG:4326</td>
</tr>
<tr class="odd">
<td>longitude</td>
<td style="text-align: left;">Longitude will be converted from coordinates presented to EPSG:4326</td>
</tr>
<tr class="even">
<td>number</td>
<td style="text-align: left;">The number of detected individuals, for capture-mark-recapture studies the number of distinct individuals will be entered. For studies not explicitly reporting non-detection, values of 0 for a species or genus will be entered if it is detected elsewhere in the study</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="pathogen-sampling" class="level3">
<h3 class="anchored" data-anchor-id="pathogen-sampling">Pathogen sampling</h3>
<p>Pathogen assays are extracted in the <code>pathogen</code> sheet. This includes information on the host the sample originated from, the pathogen family and species being assayed for and the method of the assay. For studies conducting multiple assays on the same samples for different pathogens additional records will be added for each assay. Similarly, if antibody and direct detection for the same pathogen on the same samples is performed additional records will be added.</p>
<div id="tbl-pathogen" class="anchored">
<table class="table">
<caption>Table&nbsp;3: Pathogen information extraction sheet</caption>
<colgroup>
<col style="width: 30%">
<col style="width: 69%">
</colgroup>
<thead>
<tr class="header">
<th>Column name</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>pathogen_record_id</td>
<td style="text-align: left;">A unique identifier for the group of samples from the same rodent species, at a specific location or timepoint, tested for the same pathogen using the same method</td>
</tr>
<tr class="even">
<td>study_id</td>
<td style="text-align: left;">A unique identifier to link a study to the <code>descriptive</code> sheet entry for that study</td>
</tr>
<tr class="odd">
<td>date</td>
<td style="text-align: left;">The period in which data collection of rodent samples occurred, this will be extracted at the highest temporal resolution provided</td>
</tr>
<tr class="even">
<td>host_genus</td>
<td style="text-align: left;">The genus of the small-mammal from which the sample originated as reported in the study</td>
</tr>
<tr class="odd">
<td>host_species</td>
<td style="text-align: left;">The species of the small-mammal from which the sample originated as reported in the study</td>
</tr>
<tr class="even">
<td>location</td>
<td style="text-align: left;">The location of sampling effort, depending on how data are presented in the study this will match to the coordinates given for trapping effort. i.e.&nbsp;if trapping is aggregated at village level, village names will be used</td>
</tr>
<tr class="odd">
<td>country</td>
<td style="text-align: left;">Country where trapping occurred, for multinational studies where numbers are not disaggregated by country, all countries will be included</td>
</tr>
<tr class="even">
<td>habitat_type</td>
<td style="text-align: left;">High level habitat type will be recorded here at the scale for which trapping is recorded</td>
</tr>
<tr class="odd">
<td>coordinate_resolution</td>
<td style="text-align: left;">The description of coordinate levels provided in the study, i.e.&nbsp;aggregated at study site or study region</td>
</tr>
<tr class="even">
<td>latitude</td>
<td style="text-align: left;">Latitude will be converted from coordinates presented to EPSG:4326</td>
</tr>
<tr class="odd">
<td>longitude</td>
<td style="text-align: left;">Longitude will be converted from coordinates presented to EPSG:4326</td>
</tr>
<tr class="even">
<td>pathogen_family</td>
<td style="text-align: left;">The family of virus being assayed for (i.e.&nbsp;Arenaviridae or Hantaviridae)</td>
</tr>
<tr class="odd">
<td>pathogen_species</td>
<td style="text-align: left;">The species of virus being assayed for if a specific test is being used. For assays unable to differentiate between multiple viral species <code>Multiple</code> will be entered</td>
</tr>
<tr class="even">
<td>detection_method</td>
<td style="text-align: left;">Whether the assay is attempting to detect antibody, direct detection of virus (i.e.&nbsp;pcr), or other</td>
</tr>
<tr class="odd">
<td>number_tested</td>
<td style="text-align: left;">The number of distinct samples tested</td>
</tr>
<tr class="even">
<td>number_negative</td>
<td style="text-align: left;">The number of reported negative samples</td>
</tr>
<tr class="odd">
<td>number_positive</td>
<td style="text-align: left;">The number of reported positive samples</td>
</tr>
<tr class="even">
<td>number_inconclusive</td>
<td style="text-align: left;">The number of samples with inconclusive results</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="pathogen-sequences" class="level3">
<h3 class="anchored" data-anchor-id="pathogen-sequences">Pathogen sequences</h3>
<p>If studies include linkage to complete or partial sequences of viruses archived in NCBI they will be lined through the <code>pathogen_sequences</code> sheet.</p>
<div id="tbl-sequence" class="anchored">
<table class="table">
<caption>Table&nbsp;4: Pathogen sequences extraction sheet</caption>
<colgroup>
<col style="width: 30%">
<col style="width: 69%">
</colgroup>
<thead>
<tr class="header">
<th>Column name</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>sequence_record_id</td>
<td style="text-align: left;">A unique identifier for the sequence record</td>
</tr>
<tr class="even">
<td>study_id</td>
<td style="text-align: left;">A unique identifier to link a study to the <code>descriptive</code> sheet entry for that study</td>
</tr>
<tr class="odd">
<td>host_genus</td>
<td style="text-align: left;">The genus of the small-mammal from which the sample originated as reported in the study</td>
</tr>
<tr class="even">
<td>host_species</td>
<td style="text-align: left;">The species of the small-mammal from which the sample originated as reported in the study</td>
</tr>
<tr class="odd">
<td>pathogen_species</td>
<td style="text-align: left;">The species of the pathogen</td>
</tr>
<tr class="even">
<td>accession_number</td>
<td style="text-align: left;">The accession number for each record archived by the study</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="zoonosis-status" class="level3">
<h3 class="anchored" data-anchor-id="zoonosis-status">Zoonosis status</h3>
<p>Finally, an additional sheet <code>known_zoonoses</code> will be produced containing all of the viral species sampled and whether they are known to cause disease in humans.</p>
<div id="tbl-sequence" class="anchored">
<table class="table">
<caption>Table&nbsp;5: Zoonosis status extraction sheet</caption>
<colgroup>
<col style="width: 30%">
<col style="width: 69%">
</colgroup>
<thead>
<tr class="header">
<th>Column name</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>pathogen_id</td>
<td style="text-align: left;">A unique identifier for the pathogen species</td>
</tr>
<tr class="even">
<td>pathogen_family</td>
<td style="text-align: left;">The family of pathogen</td>
</tr>
<tr class="odd">
<td>pathogen_species</td>
<td style="text-align: left;">The species of pathogen</td>
</tr>
<tr class="even">
<td>known_zoonosis</td>
<td style="text-align: left;">A logical statement of pathogenicity among humans</td>
</tr>
<tr class="odd">
<td>disease_name</td>
<td style="text-align: left;">The disease name caused by the viral species, if multiple diseases they are entered with a comma separator</td>
</tr>
<tr class="even">
<td>icd_10</td>
<td style="text-align: left;">The ICD-10 associated name of the disease (if known)</td>
</tr>
<tr class="odd">
<td>disease_reference</td>
<td style="text-align: left;">A DOI of a publication that supports the <code>known_zoonosis</code> statement</td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="data-processing" class="level2">
<h2 class="anchored" data-anchor-id="data-processing">Data processing</h2>
<p>Raw data will be downloaded from Google Sheets using the <code>googledrive</code> API in <code>R</code>, with date stamped files stored locally. Data will be imported into <code>R</code> for processing, cleaning and formatting to produce a dataset suitable for further analysis.</p>
</section>
<section id="data-management-and-accessibility" class="level2">
<h2 class="anchored" data-anchor-id="data-management-and-accessibility">Data management and accessibility</h2>
</section>
</section>
<section id="expected-outputs" class="level1">
<h1>Expected outputs</h1>
<section id="database" class="level2">
<h2 class="anchored" data-anchor-id="database">Database</h2>
</section>
<section id="data-visualisation" class="level2">
<h2 class="anchored" data-anchor-id="data-visualisation">Data visualisation</h2>
<p>An <code>RShiny</code> web-based application will be produced to visualise the database and support future analysis.</p>
</section>
<section id="use-cases" class="level2">
<h2 class="anchored" data-anchor-id="use-cases">Use cases</h2>
</section>
</section>
<section id="discussion" class="level1">
<h1>Discussion</h1>
<section id="strengths-and-limitations" class="level2">
<h2 class="anchored" data-anchor-id="strengths-and-limitations">Strengths and limitations</h2>
</section>
<section id="future-directions" class="level2">
<h2 class="anchored" data-anchor-id="future-directions">Future directions</h2>
</section>
</section>
<section id="references" class="level1">
<h1>References</h1>
<section id="rodent-sampling-1" class="level3">
<h3 class="anchored" data-anchor-id="rodent-sampling-1">Rodent sampling</h3>
<p>An example of a map produce from rodent sampling data included in the initial 9 studies is shown below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># combined_data &lt;- read_rds(here("data", "raw_data", paste0(search_date, "_data.rds")))</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># project_crs &lt;- "EPSG:4326"</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># rodent_locations &lt;- combined_data$rodent %&gt;%</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(genus, species, latitude, longitude, number) %&gt;%</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(number = as.numeric(number)) %&gt;%</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   drop_na(number) %&gt;%</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   st_as_sf(coords = c("longitude", "latitude"), crs = project_crs) %&gt;%</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(geometry, species) %&gt;%</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(number = sum(number)) %&gt;%</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   ungroup() %&gt;%</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   distinct() %&gt;%</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   rowwise() %&gt;%</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(labels = HTML(paste0("Species: ", species, "&lt;br&gt;", "Number detected: ", number)))</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># pal &lt;- colorFactor(diverging_hcl(n = length(sort(unique(rodent_locations$genus))), palette = "Berlin"),</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co">#                    domain = sort(unique(rodent_locations$genus)))</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># leaflet(data = rodent_locations) %&gt;%</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co">#   addTiles() %&gt;%</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co">#   addCircleMarkers(radius = ~ifelse(sqrt(number) == 0, 1, sqrt(number)),</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co">#                    color = ~pal(genus),</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co">#                    stroke = FALSE,</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co">#                    fillOpacity = 0.8,</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co">#                    clusterOptions = markerClusterOptions(spiderfyOnMaxZoom = TRUE,</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                          spiderLegPolylineOptions = list(length = 6),</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                          spiderfyDistanceMultiplier = 2),</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="co">#                    label = ~labels,</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="co">#                    popup = ~labels) %&gt;%</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="co">#   addLegend("bottomright", pal = pal, values = ~genus, title = "Host genus", opacity = 0.8)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="pathogen-detection" class="level3">
<h3 class="anchored" data-anchor-id="pathogen-detection">Pathogen detection</h3>
<p>A similar map can be produced to map pathogen detection with separate layers for acute infection (i.e.&nbsp;PCR positive samples) and evidence of prior infection (i.e.&nbsp;antibody positive samples)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pathogen_locations &lt;- combined_data$pathogen %&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(detection_method, pathogen_family, pathogen_species, host_species, latitude, longitude, number_tested, number_positive) %&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(number_tested = as.numeric(number_tested),</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">#          number_positive = as.numeric(number_positive)) %&gt;%</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   drop_na(number_tested, number_positive) %&gt;%</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   st_as_sf(coords = c("longitude", "latitude"), crs = project_crs) %&gt;%</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(geometry, detection_method, pathogen_family, pathogen_species, host_species) %&gt;%</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(number_tested = sum(number_tested),</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">#          number_positive = sum(number_positive)) %&gt;%</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   ungroup() %&gt;%</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   distinct() %&gt;%</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(percent_positive = case_when(is.nan(number_positive/number_tested * 100) ~ "NA",</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                                       number_positive == 0 ~ "NA",</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                                       number_positive/number_tested * 100 &lt; 1 ~ "&lt; 1%",</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                                       TRUE ~ paste0(as.character(round(number_positive/number_tested * 100, 2)), "%")),</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co">#          detection_method = case_when(detection_method == "pcr" ~ "Viral",</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co">#                                       detection_method == "antibody" ~ "Antibody"),</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co">#          detection = case_when(number_positive &gt;= 1 ~ "Detected",</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co">#                                TRUE ~ "Not detected")) %&gt;%</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co">#   rowwise() %&gt;%</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(labels = HTML(paste0("Pathogen family: ", pathogen_family, "&lt;br&gt;",</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co">#                               "Pathogen species: ", pathogen_species, "&lt;br&gt;",</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="co">#                               "Host species: ", host_species, "&lt;br&gt;",</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="co">#                               "Number tested: ", number_tested, "&lt;br&gt;",</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="co">#                               "Number positive (%): ", number_positive, " (", percent_positive, ")", "&lt;br&gt;")))</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="co"># path_pal &lt;- colorFactor(diverging_hcl(n = length(unique(pathogen_locations$pathogen_species)), palette = "Berlin"),</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="co">#                         domain = sort(unique(pathogen_locations$pathogen_species)))</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="co"># stroke_pal &lt;- colorFactor(palette = c("white", "gray"), levels = c("Detected", "Not detected"))</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="co"># leaflet(data = pathogen_locations) %&gt;%</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="co">#   addTiles() %&gt;%</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="co">#   addCircleMarkers(data = pathogen_locations %&gt;%</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="co">#                      filter(detection_method == "Viral") %&gt;%</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="co">#                      filter(number_tested != 0),</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a><span class="co">#                    radius = ~ifelse(sqrt(number_tested) == 0, 1, sqrt(number_tested)),</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="co">#                    fill = TRUE,</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a><span class="co">#                    fillColor = ~path_pal(pathogen_species),</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a><span class="co">#                    stroke = TRUE,</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a><span class="co">#                    color = ~stroke_pal(detection),</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a><span class="co">#                    weight = 2,</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a><span class="co">#                    opacity = 1,</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a><span class="co">#                    fillOpacity = 0.8,</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a><span class="co">#                    clusterOptions = markerClusterOptions(spiderfyOnMaxZoom = TRUE,</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                          spiderLegPolylineOptions = list(length = 6),</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                          spiderfyDistanceMultiplier = 2),</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a><span class="co">#                    label = ~labels,</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a><span class="co">#                    popup = ~labels,</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a><span class="co">#                    group = "Viral detection") %&gt;%</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a><span class="co">#   addCircleMarkers(data = pathogen_locations %&gt;%</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a><span class="co">#                      filter(detection_method == "Antibody") %&gt;%</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a><span class="co">#                      filter(number_tested != 0),</span></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a><span class="co">#                    radius = ~ifelse(sqrt(number_tested) == 0, 1, sqrt(number_tested)),</span></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a><span class="co">#                    fill = TRUE,</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a><span class="co">#                    fillColor = ~path_pal(pathogen_species),</span></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a><span class="co">#                    stroke = TRUE,</span></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a><span class="co">#                    color = ~stroke_pal(detection),</span></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a><span class="co">#                    weight = 2,</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a><span class="co">#                    opacity = 1,</span></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a><span class="co">#                    fillOpacity = 0.8,</span></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a><span class="co">#                    clusterOptions = markerClusterOptions(spiderfyOnMaxZoom = TRUE,</span></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                          spiderLegPolylineOptions = list(length = 6),</span></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                          spiderfyDistanceMultiplier = 2),</span></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a><span class="co">#                    label = ~labels,</span></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a><span class="co">#                    popup = ~labels,</span></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a><span class="co">#                    group = "Antibody detection") %&gt;%</span></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a><span class="co">#   addLayersControl(overlayGroups = c("Viral detection", "Antibody detection"),</span></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a><span class="co">#                    options = layersControlOptions(collapsed = FALSE)) %&gt;%</span></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a><span class="co">#   addLegend("bottomright", pal = path_pal, values = ~pathogen_species, title = "Pathogen species", opacity = 0.8)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="host-pathogen-associations" class="level3">
<h3 class="anchored" data-anchor-id="host-pathogen-associations">Host pathogen associations</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pathogen_summary &lt;- combined_data$pathogen %&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(genus = host_genus,</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#          species = host_species,</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#          pathogen_family, pathogen_species,</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">#          number_tested, number_positive,</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#          detection_method) %&gt;%</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(number_tested = as.numeric(number_tested)) %&gt;%</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(number_tested &gt;= 1) %&gt;%</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   left_join(combined_data$zoonoses %&gt;%</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">#               select(pathogen_species, known_zoonosis),</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">#             by = c("pathogen_species"))</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># hp_associations &lt;- combined_data$rodent %&gt;%</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(genus, species) %&gt;%</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   left_join(pathogen_summary %&gt;%</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co">#               group_by(detection_method, species, pathogen_species, known_zoonosis) %&gt;%</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co">#               mutate(number_tested = sum(number_tested),</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co">#                      number_positive = sum(number_positive)), by = c("genus", "species")) %&gt;%</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   drop_na(number_tested) %&gt;%</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="co">#   distinct() %&gt;%</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(!pathogen_species %in% c("Multiple", "Puumala virus/Saaremaa virus")) %&gt;%</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="co">#   arrange(pathogen_family, pathogen_species, genus, species) %&gt;%</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(association = case_when(number_positive &gt;= 1 ~ TRUE,</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  TRUE ~ FALSE),</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="co">#          detection_method = case_when(detection_method == "pcr" ~ "Viral",</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="co">#                                       detection_method == "antibody" ~ "Antibody"))</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="co"># scaled_n &lt;- preProcess(as.data.frame(log10(hp_associations$number_tested)), method = "range")</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="co"># hp_associations$alpha &lt;- predict(scaled_n, as.data.frame(log10(hp_associations$number_tested)))[, 1]</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="co"># host_pathogen_plot &lt;- hp_associations %&gt;%</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = pathogen_species, y = species)) +</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_tile(aes(fill = association, colour = known_zoonosis, alpha = alpha,</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="co">#                 text = paste0("Pathogen species: ", pathogen_species, "&lt;br&gt;",</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="co">#                               "Host species: ", species, "&lt;br&gt;",</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="co">#                               "Number tested: ", number_tested, "&lt;br&gt;",</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="co">#                               "Number positive: ", number_positive, "&lt;br&gt;",</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a><span class="co">#                               "Known zoonosis: ", known_zoonosis))) +</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_fill_viridis_d() +</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_colour_manual(values = c("white", "black")) +</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_wrap(~ detection_method) +</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a><span class="co">#   guides(alpha = "none",</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a><span class="co">#          colour = "none") +</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(fill = "H-P association",</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a><span class="co">#        x = element_blank(),</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a><span class="co">#        y = element_blank()) +</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplotly(host_pathogen_plot, tooltip = "text")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>